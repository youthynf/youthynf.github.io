import{_ as n}from"./plugin-vue_export-helper.21dcd24c.js";import{o as s,c as a,e}from"./app.a7903bab.js";const t={},p=e(`<h1 id="\u6DF1\u5165\u5256\u6790spring-bean\u751F\u547D\u5468\u671F-\u4ECE\u8BDE\u751F\u5230\u6D88\u4EA1\u7684\u5168\u8FC7\u7A0B" tabindex="-1"><a class="header-anchor" href="#\u6DF1\u5165\u5256\u6790spring-bean\u751F\u547D\u5468\u671F-\u4ECE\u8BDE\u751F\u5230\u6D88\u4EA1\u7684\u5168\u8FC7\u7A0B" aria-hidden="true">#</a> \u6DF1\u5165\u5256\u6790Spring Bean\u751F\u547D\u5468\u671F\uFF1A\u4ECE\u8BDE\u751F\u5230\u6D88\u4EA1\u7684\u5168\u8FC7\u7A0B</h1><p>\u4F5C\u4E3AJava\u5F00\u53D1\u8005\u6700\u719F\u6089\u7684\u6846\u67B6\uFF0CSpring\u7684\u6838\u5FC3\u5C31\u662FBean\u7684\u7BA1\u7406\u3002\u4F46\u4F60\u771F\u7684\u4E86\u89E3\u4E00\u4E2ABean\u4ECE\u521B\u5EFA\u5230\u9500\u6BC1\u7684\u5B8C\u6574\u751F\u547D\u5468\u671F\u5417\uFF1F\u672C\u6587\u5C06\u5E26\u4F60\u6DF1\u5165Spring\u5185\u90E8\uFF0C\u5B8C\u6574\u89E3\u6790Bean\u751F\u547D\u5468\u671F\u7684\u6BCF\u4E2A\u5173\u952E\u9636\u6BB5\uFF01</p><h2 id="\u4E00\u3001\u5BB9\u5668\u542F\u52A8\u9636\u6BB5-bean\u7684-\u5B55\u80B2\u671F" tabindex="-1"><a class="header-anchor" href="#\u4E00\u3001\u5BB9\u5668\u542F\u52A8\u9636\u6BB5-bean\u7684-\u5B55\u80B2\u671F" aria-hidden="true">#</a> \u4E00\u3001\u5BB9\u5668\u542F\u52A8\u9636\u6BB5\uFF1ABean\u7684&quot;\u5B55\u80B2\u671F&quot;</h2><h3 id="_1-bean\u5B9A\u4E49\u52A0\u8F7D" tabindex="-1"><a class="header-anchor" href="#_1-bean\u5B9A\u4E49\u52A0\u8F7D" aria-hidden="true">#</a> 1. Bean\u5B9A\u4E49\u52A0\u8F7D</h3><p>Spring\u5BB9\u5668\u542F\u52A8\u65F6\uFF0C\u4F1A\u8BFB\u53D6\u6240\u6709\u914D\u7F6E\u6E90\uFF0C\u83B7\u53D6Bean\u7684\u5B9A\u4E49\u4FE1\u606F\uFF0C\u4E3ABean\u4FE1\u606F\u7684\u6CE8\u518C\u505A\u51C6\u5907\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// \u914D\u7F6E\u6765\u6E90\u793A\u4F8B</span>
<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AppConfig</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Bean</span><span class="token punctuation">(</span>initMethod <span class="token operator">=</span> <span class="token string">&quot;init&quot;</span><span class="token punctuation">,</span> destroyMethod <span class="token operator">=</span> <span class="token string">&quot;cleanup&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">MyBean</span> <span class="token function">myBean</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">MyBean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>\u652F\u6301XML/\u6CE8\u89E3/Java\u914D\u7F6E\u4E09\u79CD\u65B9\u5F0F\u5B9A\u4E49Bean\u5BF9\u8C61</li><li>\u6700\u7EC8\u90FD\u4F1A\u89E3\u6790\u4E3ABeanDefinition\u5BF9\u8C61</li></ul><h3 id="_2-beandefinitionregistrypostprocessor\u5E72\u9884" tabindex="-1"><a class="header-anchor" href="#_2-beandefinitionregistrypostprocessor\u5E72\u9884" aria-hidden="true">#</a> 2. BeanDefinitionRegistryPostProcessor\u5E72\u9884</h3><p>BeanDefinitionRegistryPostProcessor\u662FSpring\u6846\u67B6\u4E2D\u6BD4BeanFactoryPostProcessor\u66F4\u5F3A\u5927\u7684\u6269\u5C55\u70B9\uFF0C\u5141\u8BB8\u5728\u6807\u51C6Bean\u5B9A\u4E49\u52A0\u8F7D\u540E\u3001\u4F46\u5728Bean\u5B9E\u4F8B\u5316\u524D\u5BF9Bean\u5B9A\u4E49\u6CE8\u518C\u8868\u8FDB\u884C\u66F4\u5E95\u5C42\u7684\u64CD\u4F5C\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyRegistryPostProcessor</span> <span class="token keyword">implements</span>
<span class="token class-name">BeanDefinitionRegistryPostProcessor</span><span class="token punctuation">,</span> <span class="token class-name">PriorityOrdered</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">postProcessBeanDefinitionRegistry</span><span class="token punctuation">(</span>
            <span class="token class-name">BeanDefinitionRegistry</span> registry<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// \u52A8\u6001\u6CE8\u518C\u65B0Bean\uFF08\u5982MyBatis\u7684Mapper\u626B\u63CF\uFF09</span>
        registry<span class="token punctuation">.</span><span class="token function">registerBeanDefinition</span><span class="token punctuation">(</span><span class="token string">&quot;dynamicBean&quot;</span><span class="token punctuation">,</span> 
            <span class="token keyword">new</span> <span class="token class-name">RootBeanDefinition</span><span class="token punctuation">(</span><span class="token class-name">DynamicBean</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getOrder</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// \u6700\u9AD8\u4F18\u5148\u7EA7</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u5178\u578B\u5E94\u7528\u573A\u666F\uFF1A</strong></p><ul><li>MyBatis\u7684MapperScannerConfigurer\uFF0C\u5B9E\u73B0\u81EA\u52A8\u626B\u63CF\u548C\u6CE8\u518CMyBatis\u7684Mapper\u63A5\u53E3</li><li>Spring Boot\u7684\u6761\u4EF6\u88C5\u914D\uFF08@Conditional\uFF09\uFF0C\u5B9E\u73B0\u81EA\u52A8\u88C5\u914D</li><li>\u52A8\u6001\u6CE8\u518CBean</li></ul><p><strong>\u4E09\u79CD\u63A7\u5236\u65B9\u5F0F\uFF08\u4F18\u5148\u7EA7\u7531\u9AD8\u5230\u4F4E\uFF09\uFF1A</strong></p><ul><li>PriorityOrdered\u63A5\u53E3\uFF1A\u6700\u9AD8\u4F18\u5148\u7EA7</li></ul><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyProcessor</span> <span class="token keyword">implements</span> <span class="token class-name">BeanDefinitionRegistryPostProcessor</span><span class="token punctuation">,</span> <span class="token class-name">PriorityOrdered</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getOrder</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>Ordered\u63A5\u53E3\uFF1A\u4E2D\u7B49\u4F18\u5148\u7EA7</li></ul><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyProcessor</span> <span class="token keyword">implements</span> <span class="token class-name">BeanDefinitionRegistryPostProcessor</span><span class="token punctuation">,</span> <span class="token class-name">Ordered</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getOrder</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token number">100</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>\u65E0\u987A\u5E8F\u63A5\u53E3\uFF1A\u81EA\u7136\u987A\u5E8F\uFF08\u4E0D\u4FDD\u8BC1\u786E\u5B9A\u987A\u5E8F\uFF09</li></ul><h3 id="_3-beanfactorypostprocessor\u5E72\u9884" tabindex="-1"><a class="header-anchor" href="#_3-beanfactorypostprocessor\u5E72\u9884" aria-hidden="true">#</a> 3. BeanFactoryPostProcessor\u5E72\u9884</h3><p>BeanFactoryPostProcessor\u662FSpring\u6846\u67B6\u4E2D\u7528\u4E8E\u5728Bean\u5DE5\u5382\u521D\u59CB\u5316\u540E\u3001Bean\u5B9E\u4F8B\u5316\u524D\u5BF9Bean\u5B9A\u4E49\u8FDB\u884C\u4FEE\u6539\u7684\u6269\u5C55\u70B9\u3002\u7406\u89E3\u5176\u6267\u884C\u987A\u5E8F\u5BF9\u4E8E\u89E3\u51B3\u590D\u6742\u7684Spring\u914D\u7F6E\u95EE\u9898\u975E\u5E38\u91CD\u8981\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyBeanFactoryPostProcessor</span> <span class="token keyword">implements</span> <span class="token class-name">BeanFactoryPostProcessor</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">postProcessBeanFactory</span><span class="token punctuation">(</span>
            <span class="token class-name">ConfigurableListableBeanFactory</span> beanFactory<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">BeanDefinition</span> bd <span class="token operator">=</span> beanFactory<span class="token punctuation">.</span><span class="token function">getBeanDefinition</span><span class="token punctuation">(</span><span class="token string">&quot;myBean&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        bd<span class="token punctuation">.</span><span class="token function">setScope</span><span class="token punctuation">(</span><span class="token class-name">ConfigurableBeanFactory</span><span class="token punctuation">.</span>SCOPE_PROTOTYPE<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bd<span class="token punctuation">.</span><span class="token function">setLazyInit</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u6CE8\u610F\u6267\u884C\u987A\u5E8F\uFF1A</strong></p><ol><li>\u5B9E\u73B0PriorityOrdered\u63A5\u53E3\u7684\u5904\u7406\u5668\uFF0C\u4F18\u5148\u7EA7\u6700\u9AD8</li><li>\u5B9E\u73B0Ordered\u63A5\u53E3\u7684\u5904\u7406\u5668\uFF0C\u4F18\u5148\u7EA7\u6B21\u4E4B</li><li>\u5E38\u89C4\u5904\u7406\u5668\uFF0C\u6700\u540E\u6267\u884C</li></ol><p>\u5BF9\u4E8E\u540C\u7EA7\u522B\u5904\u7406\u5668\u6309 getOrder()\u8FD4\u56DE\u503C\u6392\u5E8F\uFF08\u503C\u8D8A\u5C0F\u4F18\u5148\u7EA7\u8D8A\u9AD8\uFF09\uFF0C\u5F53\u672A\u6307\u5B9A\u987A\u5E8F\u65F6\uFF0C\u6267\u884C\u987A\u5E8F\u4E0D\u786E\u5B9A\u3002</p><h2 id="\u4E8C\u3001\u5B9E\u4F8B\u5316\u9636\u6BB5-bean\u7684-\u51FA\u751F" tabindex="-1"><a class="header-anchor" href="#\u4E8C\u3001\u5B9E\u4F8B\u5316\u9636\u6BB5-bean\u7684-\u51FA\u751F" aria-hidden="true">#</a> \u4E8C\u3001\u5B9E\u4F8B\u5316\u9636\u6BB5\uFF1ABean\u7684&quot;\u51FA\u751F&quot;</h2><h3 id="_4-instantiationawarebeanpostprocessor\u524D\u7F6E\u5904\u7406" tabindex="-1"><a class="header-anchor" href="#_4-instantiationawarebeanpostprocessor\u524D\u7F6E\u5904\u7406" aria-hidden="true">#</a> 4. InstantiationAwareBeanPostProcessor\u524D\u7F6E\u5904\u7406</h3><p>InstantiationAwareBeanPostProcessor\u662FSpring\u5BB9\u5668\u4E2D\u529F\u80FD\u5F3A\u5927\u7684\u6269\u5C55\u63A5\u53E3\uFF0C\u5141\u8BB8\u5728Bean\u5B9E\u4F8B\u5316\u524D\u540E\u8FDB\u884C\u62E6\u622A\u548C\u5904\u7406\u3002\u5176\u524D\u7F6E\u5904\u7406\u80FD\u529B\u4E3A\u5F00\u53D1\u8005\u63D0\u4F9B\u4E86\u5728Bean\u751F\u547D\u5468\u671F\u65E9\u671F\u4ECB\u5165\u7684\u673A\u4F1A\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyInstantiationProcessor</span> <span class="token keyword">implements</span>
<span class="token class-name">InstantiationAwareBeanPostProcessor</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">postProcessBeforeInstantiation</span><span class="token punctuation">(</span>
            <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> beanClass<span class="token punctuation">,</span> <span class="token class-name">String</span> beanName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">&quot;myService&quot;</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>beanName<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token class-name">Proxy</span><span class="token punctuation">.</span><span class="token function">newProxyInstance</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// \u8FD4\u56DE\u4EE3\u7406\u5BF9\u8C61</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span> <span class="token comment">// \u7EE7\u7EED\u9ED8\u8BA4\u5B9E\u4F8B\u5316</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u5178\u578B\u5E94\u7528\uFF1A</strong></p><ul><li>Spring AOP\u7684AbstractAutoProxyCreator\uFF0C\u5B9E\u73B0\u81EA\u52A8\u4EE3\u7406\u521B\u5EFA\u7684\u6838\u5FC3\u62BD\u8C61\u7C7B\uFF0C\u4E3A Spring \u7684\u58F0\u660E\u5F0F\u4E8B\u52A1\u7BA1\u7406\u3001\u7F13\u5B58\u3001\u5B89\u5168\u7B49 AOP \u529F\u80FD\u63D0\u4F9B\u4E86\u57FA\u7840\u652F\u6301</li><li>\u8DF3\u8FC7\u7279\u5B9ABean\u7684\u5B9E\u4F8B\u5316</li></ul><h3 id="_5-\u771F\u6B63\u7684\u5B9E\u4F8B\u5316\u8FC7\u7A0B" tabindex="-1"><a class="header-anchor" href="#_5-\u771F\u6B63\u7684\u5B9E\u4F8B\u5316\u8FC7\u7A0B" aria-hidden="true">#</a> 5. \u771F\u6B63\u7684\u5B9E\u4F8B\u5316\u8FC7\u7A0B</h3><p>\u901A\u8FC7\u4EE5\u4E0B\u65B9\u5F0F\u521B\u5EFA\u5B9E\u4F8B\uFF1A</p><ul><li>\u6784\u9020\u51FD\u6570\u53CD\u5C04\uFF08\u6700\u5E38\u89C1\uFF09</li><li>\u9759\u6001\u5DE5\u5382\u65B9\u6CD5</li><li>\u5B9E\u4F8B\u5DE5\u5382\u65B9\u6CD5</li></ul><p>\u6B64\u65F6\u5F97\u5230\u7684\u53EA\u662F&quot;\u88F8\u5B9E\u4F8B&quot;\uFF0C\u6240\u6709\u4F9D\u8D56\u90FD\u672A\u6CE8\u5165\uFF01</p><h2 id="\u4E09\u3001\u4F9D\u8D56\u6CE8\u5165\u9636\u6BB5-bean\u7684-\u6210\u957F" tabindex="-1"><a class="header-anchor" href="#\u4E09\u3001\u4F9D\u8D56\u6CE8\u5165\u9636\u6BB5-bean\u7684-\u6210\u957F" aria-hidden="true">#</a> \u4E09\u3001\u4F9D\u8D56\u6CE8\u5165\u9636\u6BB5\uFF1ABean\u7684&quot;\u6210\u957F&quot;</h2><h3 id="_6-instantiationawarebeanpostprocessor\u5C5E\u6027\u5904\u7406" tabindex="-1"><a class="header-anchor" href="#_6-instantiationawarebeanpostprocessor\u5C5E\u6027\u5904\u7406" aria-hidden="true">#</a> 6. InstantiationAwareBeanPostProcessor\u5C5E\u6027\u5904\u7406</h3><p>InstantiationAwareBeanPostProcessor\u5728Spring\u5C5E\u6027\u5904\u7406\u9636\u6BB5\u626E\u6F14\u7740\u5173\u952E\u89D2\u8272\uFF0C\u63D0\u4F9B\u4E86\u5BF9\u4F9D\u8D56\u6CE8\u5165\u8FC7\u7A0B\u7684\u7CBE\u7EC6\u63A7\u5236\u3002\u5176\u4E2DpostProcessAfterInstantiation\u540E\u5B9E\u4F8B\u5316\u62E6\u622A\u9636\u6BB5\uFF0C\u5728\u5BF9\u8C61\u5B9E\u4F8B\u5316\u540E\uFF08\u6784\u9020\u51FD\u6570\u6267\u884C\u5B8C\u6210\uFF09\uFF0C\u5C5E\u6027\u6CE8\u5165\u524D\u6267\u884C\uFF1B\u800CpostProcessProperties\u5219\u662F\u5C5E\u6027\u503C\u5E94\u7528\u524D\u6700\u540E\u4FEE\u6539\u673A\u4F1A\uFF08Spring 5.1+\u63A8\u8350\uFF09\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">postProcessAfterInstantiation</span><span class="token punctuation">(</span><span class="token class-name">Object</span> bean<span class="token punctuation">,</span> <span class="token class-name">String</span> beanName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>bean <span class="token keyword">instanceof</span> <span class="token class-name">SpecialBean</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// \u624B\u52A8\u8BBE\u7F6E\u5C5E\u6027\uFF0C\u8DF3\u8FC7Spring\u81EA\u52A8\u6CE8\u5165</span>
        <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">SpecialBean</span><span class="token punctuation">)</span> bean<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setSpecialProperty</span><span class="token punctuation">(</span><span class="token string">&quot;manual&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span> <span class="token comment">// \u963B\u6B62\u540E\u7EED\u5C5E\u6027\u6CE8\u5165</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">// \u5141\u8BB8\u6B63\u5E38\u6CE8\u5165</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token class-name">PropertyValues</span> <span class="token function">postProcessProperties</span><span class="token punctuation">(</span><span class="token class-name">PropertyValues</span> pvs<span class="token punctuation">,</span> <span class="token class-name">Object</span> bean<span class="token punctuation">,</span> <span class="token class-name">String</span> beanName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>bean <span class="token keyword">instanceof</span> <span class="token class-name">ConfigurableBean</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">MutablePropertyValues</span> mpvs <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">MutablePropertyValues</span><span class="token punctuation">)</span> pvs<span class="token punctuation">;</span>
        mpvs<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;timeout&quot;</span><span class="token punctuation">,</span> <span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// \u8986\u76D6\u914D\u7F6E\u503C</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> pvs<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u5178\u578B\u4F7F\u7528\u573A\u666F\uFF1A</strong></p><ul><li>\u5B9E\u73B0\u52A8\u6001\u5C5E\u6027\u6CE8\u5165</li></ul><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token class-name">PropertyValues</span> <span class="token function">postProcessProperties</span><span class="token punctuation">(</span><span class="token class-name">PropertyValues</span> pvs<span class="token punctuation">,</span> <span class="token class-name">Object</span> bean<span class="token punctuation">,</span> <span class="token class-name">String</span> beanName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>bean <span class="token keyword">instanceof</span> <span class="token class-name">EnvironmentAwareBean</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">MutablePropertyValues</span> values <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MutablePropertyValues</span><span class="token punctuation">(</span>pvs<span class="token punctuation">)</span><span class="token punctuation">;</span>
        values<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;environment&quot;</span><span class="token punctuation">,</span> <span class="token function">determineRuntimeEnvironment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> values<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> pvs<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>\u5C5E\u6027\u503C\u7684\u8F6C\u6362</li></ul><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token class-name">PropertyValues</span> <span class="token function">postProcessProperties</span><span class="token punctuation">(</span><span class="token class-name">PropertyValues</span> pvs<span class="token punctuation">,</span> <span class="token class-name">Object</span> bean<span class="token punctuation">,</span> <span class="token class-name">String</span> beanName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>bean <span class="token keyword">instanceof</span> <span class="token class-name">DateFormatBean</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">MutablePropertyValues</span> mpvs <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MutablePropertyValues</span><span class="token punctuation">(</span>pvs<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>mpvs<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">&quot;datePattern&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">String</span> pattern <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> mpvs<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;datePattern&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            mpvs<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;formatter&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">SimpleDateFormat</span><span class="token punctuation">(</span>pattern<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> mpvs<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> pvs<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>\u6761\u4EF6\u5C5E\u6027\u7684\u6CE8\u5165</li></ul><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">postProcessAfterInstantiation</span><span class="token punctuation">(</span><span class="token class-name">Object</span> bean<span class="token punctuation">,</span> <span class="token class-name">String</span> beanName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>bean <span class="token keyword">instanceof</span> <span class="token class-name">FeatureToggleBean</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// \u6839\u636E\u7279\u6027\u5F00\u5173\u51B3\u5B9A\u662F\u5426\u6CE8\u5165</span>
        <span class="token keyword">return</span> featureManager<span class="token punctuation">.</span><span class="token function">isEnabled</span><span class="token punctuation">(</span><span class="token string">&quot;dynamic_injection&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_7-\u4F9D\u8D56\u6CE8\u5165\u7684\u5B8C\u6574\u6D41\u7A0B" tabindex="-1"><a class="header-anchor" href="#_7-\u4F9D\u8D56\u6CE8\u5165\u7684\u5B8C\u6574\u6D41\u7A0B" aria-hidden="true">#</a> 7. \u4F9D\u8D56\u6CE8\u5165\u7684\u5B8C\u6574\u6D41\u7A0B</h3><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ExampleService</span> <span class="token punctuation">{</span>
<span class="token annotation punctuation">@Autowired</span>
<span class="token keyword">private</span> <span class="token class-name">UserRepository</span> repository<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;\${app.timeout}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> timeout<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u6CE8\u5165\u987A\u5E8F\uFF08\u4F18\u5148\u7EA7\u4ECE\u9AD8\u5230\u4F4E\uFF09\uFF1A</strong></p><ol><li>@Autowired\u5B57\u6BB5\u6CE8\u5165\uFF0C\u6700\u5148\u6CE8\u5165</li><li>@Autowired\u65B9\u6CD5\u6CE8\u5165\uFF0C\u5176\u6B21\u6CE8\u5165</li><li>@Resource\u6CE8\u5165\uFF0C\u968F\u540E\u6CE8\u5165</li><li>@Value(&quot;\${app.timeout}&quot;)\uFF0C\u6700\u540E\u6267\u884C\u7684\u503C\u6CE8\u5165</li></ol><h2 id="\u56DB\u3001aware\u63A5\u53E3\u56DE\u8C03-\u83B7\u53D6\u5BB9\u5668-\u8D85\u80FD\u529B" tabindex="-1"><a class="header-anchor" href="#\u56DB\u3001aware\u63A5\u53E3\u56DE\u8C03-\u83B7\u53D6\u5BB9\u5668-\u8D85\u80FD\u529B" aria-hidden="true">#</a> \u56DB\u3001Aware\u63A5\u53E3\u56DE\u8C03\uFF1A\u83B7\u53D6\u5BB9\u5668&quot;\u8D85\u80FD\u529B&quot;</h2><p>Spring \u6846\u67B6\u4E2D\u7684 Aware \u63A5\u53E3\u662F\u4E00\u7EC4\u7279\u6B8A\u7684\u56DE\u8C03\u63A5\u53E3\uFF0C\u5141\u8BB8 Bean \u83B7\u53D6\u5BB9\u5668\u7684\u57FA\u7840\u8BBE\u65BD\u5BF9\u8C61\u3002\u8FD9\u4E9B\u56DE\u8C03\u5728 Bean \u751F\u547D\u5468\u671F\u7684\u7279\u5B9A\u9636\u6BB5\u6267\u884C\uFF0C\u4E3A Bean \u63D0\u4F9B\u4E86\u4E0E\u5BB9\u5668\u4EA4\u4E92\u7684\u80FD\u529B\u3002</p><h3 id="\u5B8C\u6574\u7684aware\u63A5\u53E3\u8C03\u7528\u987A\u5E8F" tabindex="-1"><a class="header-anchor" href="#\u5B8C\u6574\u7684aware\u63A5\u53E3\u8C03\u7528\u987A\u5E8F" aria-hidden="true">#</a> \u5B8C\u6574\u7684Aware\u63A5\u53E3\u8C03\u7528\u987A\u5E8F</h3><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AllAwareBean</span> <span class="token keyword">implements</span> <span class="token class-name">BeanNameAware</span><span class="token punctuation">,</span> <span class="token class-name">BeanClassLoaderAware</span><span class="token punctuation">,</span>
<span class="token class-name">BeanFactoryAware</span><span class="token punctuation">,</span> <span class="token class-name">EnvironmentAware</span><span class="token punctuation">,</span> <span class="token class-name">ResourceLoaderAware</span><span class="token punctuation">,</span> <span class="token class-name">ApplicationEventPublisherAware</span><span class="token punctuation">,</span> <span class="token class-name">MessageSourceAware</span><span class="token punctuation">,</span> <span class="token class-name">ApplicationContextAware</span> <span class="token punctuation">{</span>

    <span class="token comment">// \u6309\u4EE5\u4E0B\u987A\u5E8F\u8C03\u7528\uFF1A</span>
    <span class="token annotation punctuation">@Override</span> <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setBeanName</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span> <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setBeanClassLoader</span><span class="token punctuation">(</span><span class="token class-name">ClassLoader</span> cl<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span> <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setBeanFactory</span><span class="token punctuation">(</span><span class="token class-name">BeanFactory</span> bf<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span> <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setEnvironment</span><span class="token punctuation">(</span><span class="token class-name">Environment</span> env<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span> <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setResourceLoader</span><span class="token punctuation">(</span><span class="token class-name">ResourceLoader</span> rl<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span> <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setApplicationEventPublisher</span><span class="token punctuation">(</span><span class="token class-name">ApplicationEventPublisher</span> aep<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span> <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setMessageSource</span><span class="token punctuation">(</span><span class="token class-name">MessageSource</span> ms<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span> <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setApplicationContext</span><span class="token punctuation">(</span><span class="token class-name">ApplicationContext</span> ctx<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="\u4E94\u3001\u521D\u59CB\u5316\u9636\u6BB5-bean\u7684-\u6210\u4EBA\u793C" tabindex="-1"><a class="header-anchor" href="#\u4E94\u3001\u521D\u59CB\u5316\u9636\u6BB5-bean\u7684-\u6210\u4EBA\u793C" aria-hidden="true">#</a> \u4E94\u3001\u521D\u59CB\u5316\u9636\u6BB5\uFF1ABean\u7684&quot;\u6210\u4EBA\u793C&quot;</h2><h3 id="\u521D\u59CB\u5316\u6D41\u7A0B\u8BE6\u89E3" tabindex="-1"><a class="header-anchor" href="#\u521D\u59CB\u5316\u6D41\u7A0B\u8BE6\u89E3" aria-hidden="true">#</a> \u521D\u59CB\u5316\u6D41\u7A0B\u8BE6\u89E3</h3><p>Spring\u5BB9\u5668\u4E2DBean\u7684\u521D\u59CB\u5316\u65B9\u6CD5\u6267\u884C\u53EF\u4EE5\u5206\u4E3A\u4E09\u4E2A\u5C42\u6B21\uFF0C\u4F9D\u6B21\u4E3A@PostConstruct\u6CE8\u89E3\u65B9\u6CD5\u3001\u5B9E\u73B0InitializingBean\u63A5\u53E3\u5E76\u91CD\u5199afterPropertiesSet\u65B9\u6CD5\u3001XML\u4E2D\u6307\u5B9A\u81EA\u5B9A\u4E49\u7684init-method\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">InitBean</span> <span class="token punctuation">{</span>
    <span class="token comment">// 1. @PostConstruct\uFF08\u6700\u5148\u6267\u884C\uFF09</span>
    <span class="token annotation punctuation">@PostConstruct</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">postConstruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;@PostConstruct&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 2. InitializingBean\u63A5\u53E3</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">afterPropertiesSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;InitializingBean&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// 3. \u81EA\u5B9A\u4E49init\u65B9\u6CD5</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">customInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;custom init&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="beanpostprocessor\u7684\u5904\u7406" tabindex="-1"><a class="header-anchor" href="#beanpostprocessor\u7684\u5904\u7406" aria-hidden="true">#</a> BeanPostProcessor\u7684\u5904\u7406</h3><p>BeanPostProcessor \u662F Spring \u6846\u67B6\u4E2D\u6700\u6838\u5FC3\u7684\u6269\u5C55\u63A5\u53E3\u4E4B\u4E00\uFF0C\u4E3A\u5F00\u53D1\u8005\u63D0\u4F9B\u4E86\u5728 Bean \u521D\u59CB\u5316\u524D\u540E\u8FDB\u884C\u81EA\u5B9A\u4E49\u5904\u7406\u7684\u5F3A\u5927\u80FD\u529B\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyBeanPostProcessor</span> <span class="token keyword">implements</span> <span class="token class-name">BeanPostProcessor</span><span class="token punctuation">,</span> <span class="token class-name">Ordered</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">postProcessBeforeInitialization</span><span class="token punctuation">(</span><span class="token class-name">Object</span> bean<span class="token punctuation">,</span> <span class="token class-name">String</span> beanName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>bean <span class="token keyword">instanceof</span> <span class="token class-name">MyBean</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;BeforeInit: &quot;</span> <span class="token operator">+</span> beanName<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> bean<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">postProcessAfterInitialization</span><span class="token punctuation">(</span><span class="token class-name">Object</span> bean<span class="token punctuation">,</span> <span class="token class-name">String</span> beanName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>bean <span class="token keyword">instanceof</span> <span class="token class-name">MyBean</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;AfterInit: &quot;</span> <span class="token operator">+</span> beanName<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// AOP\u4EE3\u7406\u901A\u5E38\u5728\u6B64\u751F\u6210</span>
            <span class="token keyword">return</span> <span class="token class-name">Enhancer</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> bean<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getOrder</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">Ordered</span><span class="token punctuation">.</span>LOWEST_PRECEDENCE<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u524D\u7F6E\u5904\u7406\u7684\u5178\u578B\u5E94\u7528\u573A\u666F\uFF1A</strong></p><ul><li>\u6CE8\u89E3\u5904\u7406\uFF08\u5982 @PostConstruct\uFF09</li><li>\u5143\u6570\u636E\u51C6\u5907</li><li>\u4EE3\u7406\u9884\u5904\u7406</li></ul><p><strong>\u540E\u7F6E\u5904\u7406\u7684\u5178\u578B\u5E94\u7528\u573A\u666F\uFF1A</strong></p><ul><li>AOP\u4EE3\u7406\u521B\u5EFA</li><li>\u5305\u88C5\u5BF9\u8C61\u751F\u6210</li><li>\u6700\u7EC8\u68C0\u67E5</li></ul><h2 id="\u516D\u3001\u4F7F\u7528\u9636\u6BB5-bean\u7684-\u9EC4\u91D1\u65F6\u671F" tabindex="-1"><a class="header-anchor" href="#\u516D\u3001\u4F7F\u7528\u9636\u6BB5-bean\u7684-\u9EC4\u91D1\u65F6\u671F" aria-hidden="true">#</a> \u516D\u3001\u4F7F\u7528\u9636\u6BB5\uFF1ABean\u7684&quot;\u9EC4\u91D1\u65F6\u671F&quot;</h2><p>\u6B64\u65F6Bean\u5DF2\u7ECF\u5B8C\u5168\u521D\u59CB\u5316\uFF1A</p><ul><li>\u53EF\u4EE5\u901A\u8FC7ApplicationContext.getBean()\u83B7\u53D6</li><li>\u53EF\u4EE5\u88AB\u5176\u4ED6Bean\u6B63\u5E38\u4F9D\u8D56</li><li>\u6240\u6709\u4EE3\u7406\u90FD\u5DF2\u7ECF\u751F\u6210</li></ul><h2 id="\u4E03\u3001\u9500\u6BC1\u9636\u6BB5-bean\u7684-\u4E34\u7EC8\u5173\u6000" tabindex="-1"><a class="header-anchor" href="#\u4E03\u3001\u9500\u6BC1\u9636\u6BB5-bean\u7684-\u4E34\u7EC8\u5173\u6000" aria-hidden="true">#</a> \u4E03\u3001\u9500\u6BC1\u9636\u6BB5\uFF1ABean\u7684&quot;\u4E34\u7EC8\u5173\u6000&quot;</h2><h3 id="\u9500\u6BC1\u65B9\u6CD5\u6267\u884C\u987A\u5E8F" tabindex="-1"><a class="header-anchor" href="#\u9500\u6BC1\u65B9\u6CD5\u6267\u884C\u987A\u5E8F" aria-hidden="true">#</a> \u9500\u6BC1\u65B9\u6CD5\u6267\u884C\u987A\u5E8F</h3><p>Spring \u5BB9\u5668\u4E2D Bean \u7684\u9500\u6BC1\u8FC7\u7A0B\u662F\u4E00\u4E2A\u4E0E\u521D\u59CB\u5316\u76F8\u5BF9\u5E94\u7684\u53CD\u5411\u6D41\u7A0B\uFF0C\u540C\u6837\u9075\u5FAA\u4E25\u683C\u7684\u6267\u884C\u987A\u5E8F\u3002\u4F18\u5148\u7EA7\u4ECE\u9AD8\u5230\u4F4E\uFF1A</p><ol><li>DestructionAwareBeanPostProcessor \u524D\u7F6E\u5904\u7406</li></ol><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">DestructionAwareBeanPostProcessor</span> <span class="token keyword">extends</span> <span class="token class-name">BeanPostProcessor</span> <span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token function">postProcessBeforeDestruction</span><span class="token punctuation">(</span><span class="token class-name">Object</span> bean<span class="token punctuation">,</span> <span class="token class-name">String</span> beanName<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>@PreDestroy\u6CE8\u89E3\u65B9\u6CD5\uFF08JSR-250\u6807\u51C6\uFF09</li></ol><ul><li>\u6700\u5148\u6267\u884C\u7684\u9500\u6BC1\u903B\u8F91</li><li>\u9002\u7528\u4E8E\u4EFB\u4F55Spring\u7BA1\u7406\u7684Bean</li><li>\u65B9\u6CD5\u53EF\u89C1\u6027\u4E0D\u9650\uFF08private\u4E5F\u53EF\uFF09</li></ul><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OrderService</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@PreDestroy</span>
    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">cleanup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;1. @PreDestroy\u65B9\u6CD5\u6267\u884C&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li>DisposableBean\u63A5\u53E3\u5B9E\u73B0</li></ol><ul><li>Spring \u539F\u751F\u63A5\u53E3</li><li>\u5141\u8BB8\u629B\u51FA\u68C0\u67E5\u5F02\u5E38</li><li>\u5728 @PreDestroy\u4E4B\u540E\u6267\u884C</li></ul><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">DisposableBean</span> <span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="4"><li>\u81EA\u5B9A\u4E49destroy-method</li></ol><p>\u914D\u7F6E\u65B9\u5F0F\uFF1A</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.example.DataSource<span class="token punctuation">&quot;</span></span> <span class="token attr-name">destroy-method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>shutdown<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u6216</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Bean</span><span class="token punctuation">(</span>destroyMethod <span class="token operator">=</span> <span class="token string">&quot;cleanup&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">DataSource</span> <span class="token function">dataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">HikariDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u6267\u884C\u7279\u70B9\uFF1A</strong></p><ul><li>\u6700\u540E\u6267\u884C\u7684\u9500\u6BC1\u903B\u8F91</li><li>\u65B9\u6CD5\u540D\u81EA\u7531\u5B9A\u4E49</li><li>\u9002\u7528\u4E8E XML \u548C Java \u914D\u7F6E</li></ul><h3 id="\u4F55\u65F6\u89E6\u53D1\u9500\u6BC1" tabindex="-1"><a class="header-anchor" href="#\u4F55\u65F6\u89E6\u53D1\u9500\u6BC1" aria-hidden="true">#</a> \u4F55\u65F6\u89E6\u53D1\u9500\u6BC1\uFF1F</h3><ul><li>\u5BF9\u4E8E\u5355\u4F8BBean\uFF1A\u5728ApplicationContext.close()\u65F6</li><li>\u5BF9\u4E8E\u539F\u578BBean\uFF1A\u9700\u8981\u624B\u52A8\u8C03\u7528destroy\u65B9\u6CD5</li><li>\u5BF9\u4E8Erequest/session\u4F5C\u7528\u57DF\uFF1A\u5728\u4F5C\u7528\u57DF\u7ED3\u675F\u65F6</li></ul><h2 id="\u516B\u3001\u7279\u6B8A\u573A\u666F\u5904\u7406" tabindex="-1"><a class="header-anchor" href="#\u516B\u3001\u7279\u6B8A\u573A\u666F\u5904\u7406" aria-hidden="true">#</a> \u516B\u3001\u7279\u6B8A\u573A\u666F\u5904\u7406</h2><h3 id="_1-\u5FAA\u73AF\u4F9D\u8D56\u7684\u4E09\u7EA7\u7F13\u5B58" tabindex="-1"><a class="header-anchor" href="#_1-\u5FAA\u73AF\u4F9D\u8D56\u7684\u4E09\u7EA7\u7F13\u5B58" aria-hidden="true">#</a> 1. \u5FAA\u73AF\u4F9D\u8D56\u7684\u4E09\u7EA7\u7F13\u5B58</h3><p>Spring\u901A\u8FC7\u4E09\u7EA7\u7F13\u5B58\u89E3\u51B3\u5FAA\u73AF\u4F9D\u8D56\uFF1A</p><ol><li>singletonFactories\uFF08\u4E09\u7EA7\uFF09</li><li>earlySingletonObjects\uFF08\u4E8C\u7EA7\uFF09</li><li>singletonObjects\uFF08\u4E00\u7EA7\uFF09</li></ol><p>\u6211\u4EEC\u53EF\u4EE5\u901A\u8FC7\u65F6\u5E8F\u56FE\u6765\u8BE6\u7EC6\u4E86\u89E3Spring\u89E3\u51B3\u5FAA\u73AF\u4F9D\u8D56\u7684\u8BE6\u7EC6\u8FC7\u7A0B\uFF1A <img src="https://s2.loli.net/2025/07/11/YRMSJEwpKGDqTLi.png" alt="Spring\u5FAA\u73AF\u4F9D\u8D56\u95EE\u9898\u89E3\u51B3.png" loading="lazy"></p><h3 id="_2-factorybean\u7684\u7279\u6B8A\u5904\u7406" tabindex="-1"><a class="header-anchor" href="#_2-factorybean\u7684\u7279\u6B8A\u5904\u7406" aria-hidden="true">#</a> 2. FactoryBean\u7684\u7279\u6B8A\u5904\u7406</h3><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyFactoryBean</span> <span class="token keyword">implements</span> <span class="token class-name">FactoryBean</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">MyProduct</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">MyProduct</span> <span class="token function">getObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">MyProduct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> <span class="token function">getObjectType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">MyProduct</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u83B7\u53D6\u65B9\u5F0F\uFF1A</p><ul><li>\u83B7\u53D6FactoryBean\u672C\u8EAB\uFF1A\u540D\u79F0\u524D\u52A0&quot;&amp;&quot;\uFF08\u5982&quot;&amp;myFactoryBean&quot;\uFF09</li><li>\u83B7\u53D6\u4EA7\u54C1\u5BF9\u8C61\uFF1A\u76F4\u63A5\u4F7F\u7528bean\u540D\u79F0</li></ul><h3 id="_3-\u539F\u578Bbean\u7684\u7279\u6B8A\u6027" tabindex="-1"><a class="header-anchor" href="#_3-\u539F\u578Bbean\u7684\u7279\u6B8A\u6027" aria-hidden="true">#</a> 3. \u539F\u578BBean\u7684\u7279\u6B8A\u6027</h3><ul><li>\u6BCF\u6B21getBean()\u90FD\u8D70\u5B8C\u6574\u751F\u547D\u5468\u671F</li><li>\u5BB9\u5668\u4E0D\u7BA1\u7406\u539F\u578BBean\u7684\u9500\u6BC1</li></ul><h2 id="\u603B\u7ED3-\u5B8C\u6574\u7684\u751F\u547D\u5468\u671F\u6D41\u7A0B\u56FE" tabindex="-1"><a class="header-anchor" href="#\u603B\u7ED3-\u5B8C\u6574\u7684\u751F\u547D\u5468\u671F\u6D41\u7A0B\u56FE" aria-hidden="true">#</a> \u603B\u7ED3\uFF1A\u5B8C\u6574\u7684\u751F\u547D\u5468\u671F\u6D41\u7A0B\u56FE</h2><p><img src="https://s2.loli.net/2025/07/11/64O9RmarWycigkZ.png" alt="SpringBean.png" loading="lazy"></p><p>\u638C\u63E1Spring Bean\u7684\u5B8C\u6574\u751F\u547D\u5468\u671F\uFF0C\u80FD\u591F\u5E2E\u52A9\u60A8\uFF1A</p><ol><li>\u66F4\u9AD8\u6548\u5730\u6392\u67E5Bean\u521B\u5EFA\u95EE\u9898</li><li>\u5408\u7406\u4F7F\u7528\u6269\u5C55\u70B9\u589E\u5F3A\u6846\u67B6\u80FD\u529B</li><li>\u7F16\u5199\u66F4\u4F18\u96C5\u7684Spring\u7EC4\u4EF6</li><li>\u6DF1\u5165\u7406\u89E3Spring\u7684\u8BBE\u8BA1\u601D\u60F3</li></ol><p><strong>\u4F60\u5728\u5B9E\u9645\u5F00\u53D1\u4E2D\u9047\u5230\u8FC7\u54EA\u4E9BBean\u751F\u547D\u5468\u671F\u7684&quot;\u5751&quot;\uFF1F\u6B22\u8FCE\u7559\u8A00\u5206\u4EAB\uFF01</strong> \u{1F3A4} <img src="https://s2.loli.net/2024/07/11/I8ZVdbwQ1s7XBrC.png" alt="image.png" loading="lazy"></p>`,103),o=[p];function c(i,l){return s(),a("div",null,o)}var d=n(t,[["render",c],["__file","\u6DF1\u5165\u5256\u6790Spring\u4E2DBean\u5BF9\u8C61\u751F\u547D\u5468\u671F.html.vue"]]);export{d as default};
